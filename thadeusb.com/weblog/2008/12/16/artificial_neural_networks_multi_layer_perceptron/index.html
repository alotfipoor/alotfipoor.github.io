<!doctype html><html lang="en">
<!-- Mirrored from thadeusb.com/weblog/2008/12/16/artificial_neural_networks_multi_layer_perceptron/ by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 31 Jan 2019 17:05:50 GMT -->
<head><title>Artificial Neural Networks - Multi-Layer Perceptron - ThadeusB</title><meta charset="utf-8"><meta name=author content="Thadeus Burgess" /><meta name=description content="Multi Layer perceptron tutorial using the feed forward and back progapation algorithms. Artificial Intelligence is simply defined as making a computer seem more human. Things such as video game opponents, optical character recognition, facial recognition, voice synthesis, datamining, robotic surgery, and much more are accomplished by using artificial intelligence."/><meta name=keywords content="python, ai, robots, ai chronicles, net, orm, artificial_intelligence, back_propagation, c, feed_forward, neural_network, neuron, perceptron, supervised_learning, visual_studio, artificial, neural, networks, multi, layer, ai, chronicles"/><meta name=robots content="index, follow" /><link rel="shortcut icon" href="https://thadeusb.com/static/favicon.ico" type="image/x-icon" /><link href="http://fonts.googleapis.com/css?family=Rubik|Aclonica|Averia+Libre" rel="stylesheet"><link href="../../../../../../use.fontawesome.com/aaf60b2b39.css" rel="stylesheet"> <link rel="stylesheet" type="text/css" href="https://thadeusb.com/static/gen/app.css?5d06cfbf"><link rel="stylesheet" type="text/css" media="print" href="https://thadeusb.com/static/gen/print.css?39bef004"><meta name="viewport" content="width=device-width" /><meta name="twitter:card" content="summary"> <meta name="twitter:site" content="@thadeusb"> <meta name="twitter:creator" content="@thadeusb"> <meta name="twitter:title" content="Artificial Neural Networks - Multi-Layer Perceptron"> <meta name="twitter:description" content="Multi Layer perceptron tutorial using the feed forward and back progapation algorithms. Artificial Intelligence is simply defined as making a computer seem more human. Things such as video game opponents, optical character recognition, facial recognition, voice synthesis, datamining, robotic surgery, and much more are accomplished by using artificial intelligence."> <meta name="twitter:image" content="../../../../../index.html"></head><body class="weblog artificial_neural_networks_multi_layer_perceptron  "><div class="container"><header class="header"><h1>Hi, I'm <a href="../../../../../index.html">Thadeus<span>B</span></a>.</h1><small>I code stuff. I raise bees. I game.</small></header><main class="content"><article lang="en" class="weblog" itemscope itemtype="//schema.org/BlogPosting"><link itemprop="url" href="index.html"><header><div id="article-title"></div><h2><a itemprop="name" href="index.html">Artificial Neural Networks - Multi-Layer Perceptron</a></h2></header><section><p>This will be my first real tutorial so bear with me as I am sure it will undergo many revisions. Please feel free to ask any questions in the comments. Note:&nbsp; If I actually finish this tutorial and provide source code depends on the response I get to the article. If you liked it and would like me to write more then please let me know! <strong>What will be covered:</strong></p><ul class="simple"><li>Overview - Of Neural Networks</li><li>Multi-Layer Perceptron - A kind of neural network</li><li>Feed Foward Algorithm - Calculating an answer</li><li>Back Propagation Algorithm - Supervised Training</li><li>Application - Neural Network written in C#.NET</li></ul><div class="section" id="introduction"><h3>Introduction:</h3><p>Lets start from the beginning. Artificial Intelligence is simply defined as making a computer seem more human. The field of artificial intelligence is vast, and every month there are innovations in the field that is getting computers one step closerto their makers. Things such as video game opponents, optical character recognition, facial recognition, voice synthesis, data mining, robotic surgery, and much more are accomplished by using artificial intelligence.</p><p>One of the most popular ways to emulate human decision making is by simulating the human brain. What better way to make a computer more human than to design it like a human?</p><p>Our brain is composed of a network of cells called neurons, and these neurons are linked to each other by dendrites. Long story short, a neuron receives an input from all the dendrites it is connected to, does some math, if it is above a certain voltage level then that neuron will fire and send its value out to each neuron that is connected to it. By some act of God, that is how we have thoughts.</p><p>When we simulate this process in a computer, we call it an artificial neural network. There are a few different kinds of artificial neural networks ( ANN for short ). These are just some of the different kinds of ANN.</p><ul class="simple"><li>Feed-Foward<ul><li>Perceptron</li><li>Multi-Layer Perceptron</li></ul></li><li>Feedback<ul><li>Hopfield Net</li><li>Self- Organizing Maps</li></ul></li></ul><p>The main difference in each is how the neurons are arranged and how each neuron interacts with every other neuron. &nbsp;Since this article is about ML- perceptrons, that is all I will be explaining.</p><p>There are two ways of teaching an ANN to do what you expect it to, make an reasonable decision.</p><ul class="simple"><li>Supervised Learning</li><li>Un-supervised Learning</li></ul><p>With supervised training you give the network some input data, such as an image of a letter. It spits out an answer as to what it thinks it is (which will be wrong until it is trained). You tell it what the correct answer was, and it fixes itself so the next time it sees that same image, it will be closer to the correct answer.</p><p>In un-supervised learning the network will make its own assumptions about the input data, and over time possibly provide answers to a problem that had not even been thought of. A Self-Organizing map is an example of a un-supervised network that will organize like data into groups.</p></div><div class="section" id="basics-of-a-multi-layer-perceptron"><h3><strong>Basics of a Multi-Layer&nbsp;Perceptron:</strong></h3><p>A ML-perceptron is a ANN that is composed of layers of neurons in which each neuron in a layer is connected to every neuron in the previous layer.</p><p><strong>*Note: Dendrites are also referred to as Weights*</strong></p><p>In a ML-perceptron, there are at least three layers</p><ul class="simple"><li>1 Input</li><li>1 - ∞&nbsp;Hidden</li><li>1 Output</li></ul><p><strong>In short:</strong></p><p>The input layer receives data about something. Each input neuron represents a piece of data such as pixes to a image of a letter.</p><p>The hidden layers do some calculations.</p><p>The output layers provide an answer in percentage. Each output neuron represents a different possibility.</p><p><strong>In Long:</strong></p><p>The input layer is the layer of neurons that will be receiving the data about something. For character recognition there would need to be one neuron for each pixel in the image of the character. Obviously there can be only one input layer. Input is usually normalized to a double between 0.0 and 1.0.</p><p>The hidden layer is a layer used for calculations. This is what makes up the &quot;brain&quot; of a ML-perceptron. There can be as many hidden layers with any number of neurons. Typically one hidden layer is usually enough, though to get the best performance (learning rate vs. correctness) different configurations could betested.</p><p>The output layer is the results of what the network has calculated. For character recognition that could only see the letters of the alphabet there would need to be 32 output neurons (one for each letter). A neurons output value is a normalized double between 0.0 and 1.0. 0 is false, 1 is true. It could also be though of as apercentage of correctness for what that neuron is to represent. In the OCR network, if a neuron represented the capital letter T was a .85, that would me the network thinks the input is an 85% chance T, yet also the neuron representing the letter F might be .64, meaning the network thinks the input is an 64% chance F.</p><p><strong>The Example:</strong></p><p>The following example will go through a network that is trained to solve the XOR problem.</p><p>XOR Problem: One and only one can be true but one has to be true.</p><div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>A XOR B = C
-----------
1 XOR 1 = 0
1 XOR 0 = 1
0 XOR 1 = 1
0 XOR 0 = 0
</pre></div><p>The neural network that can solve such a problem is shown below</p><p>Since the XOR problem has only two binary inputs, the network will have two neurons in the input layer. Also since the XOR problems output is just one answer, there will only be one output neuron.</p></div><div class="section" id="how-a-multi-layer-perceptron-calculates-an-answer"><h3>How A Multi-Layer&nbsp;Perceptron Calculates An Answer:</h3><p>The calculations happen inside each individual neuron. A neuron needs three pieces of information.</p><ul class="simple"><li>Output values of every neuron in the previous layer</li><li>Value of every dendrite(weight) connecting the current neuron toevery corresponding previous neuron</li><li>Activation Function</li></ul><p>The value of every dendrite(weight) in a ML-perceptron are randomized double values between 0.0 and 1.0.</p><p>The weights of the network are what make up the magic. These are the main determiners of what the final answer is. Later, when the network is to be trained or taught, these dendrites(weights) are what will be altered.</p><p>The input layer does not have any calculations performed on it, therefore the input to the input layer neurons is also their output.</p><p>Starting with the first hidden layer and using the input layers, for each neuron in the layer sum all of the previous layers output values * their corresponding weights. Pass the sum through an activation function. Continue to the next layer. Do this for the output layer as well. The values of each neuron in the output layeris the answer from the network. This can be represented in calculus as follows:</p><blockquote>
v = Sigmoid( Σ( pv * pw ) )</blockquote><p>Where</p><ul class="simple"><li>v = output value of the neuron</li><li>Σ = calculus for [summation][5]</li><li>pv = a previous neurons output value</li><li>pw = the dendrite or weight value connecting to the previous neuron</li><li>Sigmoid = activation function</li></ul><p>There is a problem with this structure though. If all the inputs to the network are zero, when the network is training, it will not be able to learn what all zero inputs are. For this reason there must be a pseudo input added to each layer excluding the output layer. This <strong>bias</strong> acts as a neuron with a value that is always 1 or -1 and it has a dendrite (weight) attached to it and is calculated inwith the summation.</p><p><strong>The Activation:</strong></p><p>This is probably the most important calculation in a neural network. The activation function. Simply put, this function decides if the neuron should &quot;fire&quot; and send a signal to receiving neurons. There are a few types of activation functions:</p><ul class="simple"><li>Threshold</li><li>Piecewise</li><li>Sigmoid Logistics Hyperbolic Tangent Algebriac Sigmoid</li></ul><p><em>Note: A Sigmoid function is also referred to as a squashing function since it normalizes input</em></p><p>Typically a ML-Perceptron uses a sigmoid function as its activation.</p><p>The sigmoid function looks as follows:</p><blockquote>
threshold = 1
sum =&nbsp;Σ( pv * pw )
sigmoid = ( 1 / ( 1 + e ^ ( -( sum ) / threshold )))</blockquote><p>Where</p><ul class="simple"><li>e = [Mathematical constant e ][8]</li><li>sum = sum of previous neurons</li><li>threshold = Activation value</li></ul></div><div class="section" id="how-a-multi-layer-perceptron-learns"><h3>How A Multi-Layer Perceptron Learns:</h3><p>With randomized weights, it will be luck if the network spits out a correct answer. The answer will seemingly be randomized as well.</p><p>These weights are what will be altered to make the network spit out an answer more to what is being expected. However, to know how to change these weights the current output of the neural network will have to be known so that we can calculate the error rate. The error rate is how far off the neural network is from the correct answer.</p><p>The training process happens on a per-input basis. If the network is trained on one set of data, such as the letter &quot;A&quot;, it will not be trained if it comes across the letter &quot;B&quot;. All the neural network will know is how much &quot;B&quot; is like &quot;A&quot;.</p><p>Training may have to be done hundreds or even thousands of times on each kind of input until the error rate of the network is within a satisfactory range. Usually less than 1%.</p><p>The process as follows:</p><ul class="simple"><li>Compute resulting output</li><li>Compute ERROR for neurons in output layer</li><li>Compute ERROR for all other neurons</li><li>Compute CHANGE for all weights</li></ul><p><strong>To calculate the error for the output layer.</strong></p><p>Error is equal to the desired output minus the actual output.</p><blockquote>
β = d - o</blockquote><p>Where:</p><ul class="simple"><li>β = Error</li><li>d = Desired output</li><li>o = Actual output</li></ul><p><strong>To calculate the error for all other neurons.</strong></p><p>Take the weights and outputs and errors of each neuron in the right-side layer.</p><p>Sum the product of them all. Also include a 1 - output value for the slope of the line.</p><blockquote>
β<sub>j</sub>= Σ ( w<sub>k</sub>&gt; * o<sub>k</sub> ( 1 - o<sub>k</sub> ) β<sub>k</sub> )</blockquote><p>Where:</p><ul class="simple"><li>β<sub>j</sub> = Error for current neuron</li><li>w<sub>k</sub> = Weight for neuron in right-side layer</li><li>o<sub>k</sub> = Output for neuron in right-side layer</li><li>β<sub>k</sub> = Error for neuron in right-side layer</li><li>j = Current Neuron</li><li>k = Neuron in right-side layer</li><li>Σ = calculus for[summation][5]</li></ul><p><strong>To calculate the changes for the weights.</strong></p><p>For a weight of a neuron. Take the neuron in the left-side layer the weight is connected to Multiply it with the slope and the error of the current neuron Multiply in a learning rate (How fast the network will learn) .20-.25 seem to be optimal</p><blockquote>
<p>Δw<sub>j</sub> = r * o<sub>i</sub> * o<sub>j</sub> ( 1 - o<sub>j</sub> ) β<sub>j</sub></p>
<p>w<sub>j</sub>= w<sub>j</sub>+ Δw<sub>j</sub></p>
</blockquote><p>Where:</p><ul class="simple"><li>Δw<sub>j</sub> = Change in weight for current neuron</li><li>w<sub>j</sub> = Weight of the current neuron</li><li>r = Learning rate of the network ( how fast the network learns ) .2o-.25 are good.</li><li>o<sub>i</sub> = Output for neuron in the left-side layer</li><li>o<sub>j</sub> = Output for neuron in the right-side layer</li><li>β<sub>j</sub> = Error for current neuron</li><li>j = Current Neuron</li><li>i = Neuron in left-side layer</li></ul><div class="figure align-center" style="width: 25%"><img alt="Neural Network With Many Layers" src="https://thadeusb.com/static/content/weblog/2008/backprop.jpg" style="width: 95%;" /><p class="caption">Neural Network With Many Layers</p></div><p><strong>Putting it all together:</strong></p><blockquote>
<p>w<sub>j</sub> = w<sub>j</sub> + Δw<sub>j</sub> w<sub>j</sub></p>
<p>Δw<sub>j</sub> = r * o<sub>i</sub> * o<sub>j</sub> ( 1 - o<sub>j</sub> ) β<sub>j</sub></p>
<p>β<sub>j</sub> = Σ ( w<sub>k</sub> * o<sub>k</sub> ( 1 - o<sub>k</sub> ) β<sub>k</sub> )</p>
<p>β<sub>z</sub> = d - o</p>
</blockquote></div><div class="section" id="how-a-multi-layer-perceptron-can-be-used"><h3>How A Multi-Layer Perceptron Can Be Used:</h3><p>A few uses for a neural network include optical character recognition, facial recognition, texture analysis, data validation, sales forecasting, etc.</p><p>For a more extensive list visit this website<a class="reference external" href="http://www.alyuda.com/products/forecaster/neural-network-applications.htm">Alyuda.com</a></p><p>A tutorial on writing a neural network with C# will be coming soon!</p><p>The project will be a simple optical character recognition program.</p><p>List of missing files.</p><ul class="simple"><li>perceptron-300x187.jpg (Multi-Layer-Perceptron)</li><li>perceptron.jpg</li><li>perceptron-xor-300x187.jpg (Multi-Layer-Perceptron-XOR)</li><li>perceptron-xor.jpg</li><li>perceptron-activation-300x225.jpg (Muti-Layer-Perceptron-Activation)</li><li>perceptron-activation.jpg</li></ul></div></section><hr><aside><p><span class="article-author" itemprop="author" itemscope itemtype="//schema.org/Person"><span itemprop="name">Thadeus Burgess</span></span><time datetime="2008-12-16" itemprop="datePublished">2008-12-16</time>— in <a href="../../../../index.html" itemprop="genre">Weblog</a></p></aside><nav><a class="prev" href="../../../../2009/01/18/a_betterbetterpythonconsole_gedit_plugin/index.html">A BetterBetterPythonConsole - GEdit Plugin</a> |<a class="next" href="../../12/one_wordpress_one_database_multiple_domains/index.html">One Wordpress, One Database, Multiple Domains</a><div class="related"><h6>Related Entries <small>(in order of similarity)</small></h6><ul><li><a href="../../../11/12/artificial_neural_networks_day_1/index.html">Artificial Neural Networks - Day 1</a></li><li><a href="../../../../2009/12/31/web2py_virtualfields_as_an_orm_an_sqlalchemy_approach/index.html">web2py virtualfields as an ORM (an sqlalchemy approach)</a></li></ul></div></nav></article></main><nav class="sidebar"><ul><li class="home"><a href="../../../../../index.html">Home</a></li><li class="weblog active"><a href="../../../../index.html">Weblog</a></li><li class="recipes"><a href="../../../../../recipes/index.html">Recipes</a></li><li class="projects"><a href="../../../../../projects/index.html">Projects</a></li><li class="contact"><a href="../../../../../pages/contact/index.html">Contact</a></li></ul></nav><footer class="footer"><p>&copy; 2017 Thadeus Burgess— <a href="mailto:thadeusb@thadeusb.com" title="E-Mail"><i class="fa fa-fw fa-envelope"></i></a>— <a href="https://github.com/thadeusb" title="GitHub"><i class="fa fa-fw fa-github"></i></a>— <a href="https://www.linkedin.com/in/thadeusb/" title="LinkedIn"><i class="fa fa-fw fa-linkedin"></i></a></p></footer></div><div id="gear-container"><div id="gear"></div></div><script src="../../../../../../ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script> <script type="text/javascript" src="https://thadeusb.com/static/gen/app.js?35034e78"></script><!--  GOOGLE ANALYTICS --> <script>var _gaq = _gaq || [];_gaq.push(['_setAccount', 'UA-7293044-1']);_gaq.push(['_trackPageview']);(function() {  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);})();</script></body>
<!-- Mirrored from thadeusb.com/weblog/2008/12/16/artificial_neural_networks_multi_layer_perceptron/ by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 31 Jan 2019 17:05:50 GMT -->
</html>